manifest {
  // Read more at https://www.nextflow.io/docs/latest/config.html#config-manifest
  author = 'Unseen Bio ApS'
  description = 'A benchmark workflow comparing parallel-fastq-dump to the newer sra-tools\'s prefetch and fasterq-dump.'
  homePage = 'https://unseenbio.com'
  name = 'SRA Benchmark'
  nextflowVersion = '!21+'
  version = '0.1.0'
}

params {
  temp_path = '/tmp'
  tracedir = 'info'
}

/*
executor {
  // For a local benchmark, download bandwidth should not be shared.
  queueSize = 1
}
*/

process {
  withLabel: minimal_process {
    cpus = 1
  }
  withLabel: default_process {
    cpus = 4
  }
  withLabel: error_retry {
    errorStrategy = 'retry'
    maxRetries = 3
  }
  withLabel: fasterq_dump {
    container = 'quay.io/biocontainers/sra-tools:2.11.0--pl5262h314213e_0'
  }
  withLabel: parallel_fastq_dump {
    container = 'quay.io/biocontainers/parallel-fastq-dump:0.6.7--pyhdfd78af_0'
  }
}

profiles {
  docker {
    // Read more at https://www.nextflow.io/docs/latest/docker.html
    docker {
      enabled = true
      fixOwnership = true
      temp = params.temp_path
    }
  }
  conda {
    process.conda = './environment.yml'
  }
}

timeline {
  enabled = true
  file = "${params.tracedir}/timeline.html"
}
report {
  enabled = true
  file = "${params.tracedir}/report.html"
}
trace {
  enabled = true
  raw = true
  fields = 'task_id,hash,process,tag,name,status,exit,cpus,duration,%cpu,rss,peak_rss,read_bytes'
  file = "${params.tracedir}/trace.tsv"
}
dag {
  enabled = true
  file = "${params.tracedir}/pipeline_dag.svg"
}
